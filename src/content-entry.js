!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){var n,o;n=[r(1)],void 0===(o=(e=>{document.addEventListener("DOMContentLoaded",()=>{chrome.storage.sync.get("webs",({webs:t=[]})=>{console.log(t);for(let r=0,n=t.length;r<n;r+=1){const n=t[r];new e(n).start()}})})}).apply(t,n))||(e.exports=o)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(2),__webpack_require__(4),__webpack_require__(5)],__WEBPACK_AMD_DEFINE_RESULT__=((utils,templates,notify)=>{const{render:render,preDiff:preDiff,diff:diff}=utils,{parserTemplate:parserTemplate,creatorTemplate:creatorTemplate}=templates;class Runner{constructor({page:page,url:url,parserCode:parserCode,notifyCode:notifyCode,title:title,type:type="text",sleep:sleep=5e3,limit:limit=1/0}){const parser=eval(render(parserTemplate,{code:parserCode})),creator=eval(render(creatorTemplate,{code:notifyCode}));this.options={title:title,page:page,url:url,type:type,sleep:sleep,limit:limit,parser:parser,creator:creator}}start(){const{page:e}=this.options;location.href===e&&this.fetchContent()}fetchContent(){const{url:e,parser:t,type:r,sleep:n,limit:o}=this.options,i=this;let s=0,a=0,c=null;!function u(){o&&s>o||(s+=1,console.log("fetch times",s),fetch(e).then(e=>e[r]()).then(e=>{const r=preDiff(t(e,utils));if(console.log(c,r),null!==c){const{hasUpdate:e,...t}=diff(c,r);e&&(console.log("has update"),i.dispatch(t))}c=r,n?setTimeout(()=>{u()},n):u()}).catch(e=>{console.log(e),(a+=1)>3?notify({title:`${i.options.title} - 错误提示`,message:"请求错误次数太多，请检查后重启"}):u()}))}()}dispatch({addedNodes:e,removedNodes:t,updatedNodes:r}){const{creator:n}=this.options,o=n({addedNodes:e,removedNodes:t,updatedNodes:r});for(let e=0,t=o.length;e<t;e+=1){const t=o[e];notify(t)}}}return Runner}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(e,t,r){var n,o;n=[r(3)],void 0===(o=(e=>{return{removeWhiteSpace:function(e){return e.replace(/\s/g,"").replace(/↵/g,"")},render:function(t,r){return e.render(t,r)},preDiff:function(e){return e.reduce((e,t)=>{const r=e;return r[t.key]=t,r},{})},diff:function(e,t){const r=[],n=[],o=[];let i=!1;return Object.keys(t).forEach(r=>{const s=e[r],a=t[r];s?Object.keys(a).every(e=>a[e]===s[e])||(i=!0,o.push(a)):(i=!0,n.push(a))}),Object.keys(e).forEach(n=>{e[n]&&!t[n]&&(i=!0,r.push(e[n]))}),{hasUpdate:i,addedNodes:n,updatedNodes:o,removedNodes:r}}}}).apply(t,n))||(e.exports=o)},function(e,t,r){var n,o,i,s;s=function(e){var t=Object.prototype.toString,r=Array.isArray||function(e){return"[object Array]"===t.call(e)};function n(e){return"function"==typeof e}function o(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function i(e,t){return null!=e&&"object"==typeof e&&t in e}var s=RegExp.prototype.test,a=/\S/;function c(e){return!function(e,t){return s.call(e,t)}(a,e)}var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},p=/\s*/,l=/\s+/,f=/\s*=/,h=/\s*\}/,d=/#|\^|\/|>|\{|&|=|!/;function _(e){this.string=e,this.tail=e,this.pos=0}function v(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function y(){this.cache={}}_.prototype.eos=function(){return""===this.tail},_.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var r=t[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},_.prototype.scanUntil=function(e){var t,r=this.tail.search(e);switch(r){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=t.length,t},v.prototype.push=function(e){return new v(e,this)},v.prototype.lookup=function(e){var t,r,o,s=this.cache;if(s.hasOwnProperty(e))t=s[e];else{for(var a,c,u,p=this,l=!1;p;){if(e.indexOf(".")>0)for(a=p.view,c=e.split("."),u=0;null!=a&&u<c.length;)u===c.length-1&&(l=i(a,c[u])||(r=a,o=c[u],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(o))),a=a[c[u++]];else a=p.view[e],l=i(p.view,e);if(l){t=a;break}p=p.parent}s[e]=t}return n(t)&&(t=t.call(this.view)),t},y.prototype.clearCache=function(){this.cache={}},y.prototype.parse=function(t,n){var i=this.cache,s=t+":"+(n||e.tags).join(":"),a=i[s];return null==a&&(a=i[s]=function(t,n){if(!t)return[];var i,s,a,u=[],v=[],y=[],g=!1,m=!1;function w(){if(g&&!m)for(;y.length;)delete v[y.pop()];else y=[];g=!1,m=!1}function b(e){if("string"==typeof e&&(e=e.split(l,2)),!r(e)||2!==e.length)throw new Error("Invalid tags: "+e);i=new RegExp(o(e[0])+"\\s*"),s=new RegExp("\\s*"+o(e[1])),a=new RegExp("\\s*"+o("}"+e[1]))}b(n||e.tags);for(var E,x,k,A,T,C,D=new _(t);!D.eos();){if(E=D.pos,k=D.scanUntil(i))for(var j=0,N=k.length;j<N;++j)c(A=k.charAt(j))?y.push(v.length):m=!0,v.push(["text",A,E,E+1]),E+=1,"\n"===A&&w();if(!D.scan(i))break;if(g=!0,x=D.scan(d)||"name",D.scan(p),"="===x?(k=D.scanUntil(f),D.scan(f),D.scanUntil(s)):"{"===x?(k=D.scanUntil(a),D.scan(h),D.scanUntil(s),x="&"):k=D.scanUntil(s),!D.scan(s))throw new Error("Unclosed tag at "+D.pos);if(T=[x,k,E,D.pos],v.push(T),"#"===x||"^"===x)u.push(T);else if("/"===x){if(!(C=u.pop()))throw new Error('Unopened section "'+k+'" at '+E);if(C[1]!==k)throw new Error('Unclosed section "'+C[1]+'" at '+E)}else"name"===x||"{"===x||"&"===x?m=!0:"="===x&&b(k)}if(C=u.pop())throw new Error('Unclosed section "'+C[1]+'" at '+D.pos);return function(e){for(var t,r=[],n=r,o=[],i=0,s=e.length;i<s;++i)switch((t=e[i])[0]){case"#":case"^":n.push(t),o.push(t),n=t[4]=[];break;case"/":o.pop()[5]=t[2],n=o.length>0?o[o.length-1][4]:r;break;default:n.push(t)}return r}(function(e){for(var t,r,n=[],o=0,i=e.length;o<i;++o)(t=e[o])&&("text"===t[0]&&r&&"text"===r[0]?(r[1]+=t[1],r[3]=t[3]):(n.push(t),r=t));return n}(v))}(t,n)),a},y.prototype.render=function(e,t,r,n){var o=this.parse(e,n),i=t instanceof v?t:new v(t);return this.renderTokens(o,i,r,e,n)},y.prototype.renderTokens=function(e,t,r,n,o){for(var i,s,a,c="",u=0,p=e.length;u<p;++u)a=void 0,"#"===(s=(i=e[u])[0])?a=this.renderSection(i,t,r,n):"^"===s?a=this.renderInverted(i,t,r,n):">"===s?a=this.renderPartial(i,t,r,o):"&"===s?a=this.unescapedValue(i,t):"name"===s?a=this.escapedValue(i,t):"text"===s&&(a=this.rawValue(i)),void 0!==a&&(c+=a);return c},y.prototype.renderSection=function(e,t,o,i){var s=this,a="",c=t.lookup(e[1]);if(c){if(r(c))for(var u=0,p=c.length;u<p;++u)a+=this.renderTokens(e[4],t.push(c[u]),o,i);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)a+=this.renderTokens(e[4],t.push(c),o,i);else if(n(c)){if("string"!=typeof i)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(t.view,i.slice(e[3],e[5]),function(e){return s.render(e,t,o)}))&&(a+=c)}else a+=this.renderTokens(e[4],t,o,i);return a}},y.prototype.renderInverted=function(e,t,n,o){var i=t.lookup(e[1]);if(!i||r(i)&&0===i.length)return this.renderTokens(e[4],t,n,o)},y.prototype.renderPartial=function(e,t,r,o){if(r){var i=n(r)?r(e[1]):r[e[1]];return null!=i?this.renderTokens(this.parse(i,o),t,r,i):void 0}},y.prototype.unescapedValue=function(e,t){var r=t.lookup(e[1]);if(null!=r)return r},y.prototype.escapedValue=function(t,r){var n=r.lookup(t[1]);if(null!=n)return e.escape(n)},y.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="3.0.1",e.tags=["{{","}}"];var g=new y;return e.clearCache=function(){return g.clearCache()},e.parse=function(e,t){return g.parse(e,t)},e.render=function(e,t,n,o){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(r(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return g.render(e,t,n,o)},e.to_html=function(t,r,o,i){var s=e.render(t,r,o);if(!n(i))return s;i(s)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,function(e){return u[e]})},e.Scanner=_,e.Context=v,e.Writer=y,e},t&&"string"!=typeof t.nodeName?s(t):(o=[t],void 0===(i="function"==typeof(n=s)?n.apply(t,o):n)||(e.exports=i))},function(e,t,r){var n;void 0===(n=(()=>{return{parserTemplate:";(function () {\n        function parser(html, { removeWhiteSpace }) {\n            {{{code}}}\n        }\n        return parser;\n    }())",creatorTemplate:";(function() {\n        function creator(updates) {\n            {{{code}}}\n        }\n        return creator;\n    }());"}}).call(t,r,t,e))||(e.exports=n)},function(e,t,r){var n;void 0===(n=(()=>{return function(e){chrome.runtime.sendMessage({command:"notify",params:e})}}).call(t,r,t,e))||(e.exports=n)}]);